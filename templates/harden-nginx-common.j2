
location = /favicon.ico {
    log_not_found off;
    access_log off;
}
        
location = /robots.txt {
    allow all;
    log_not_found off;
    access_log off;
}
location ~* /\. {
    deny all;
}
location ~* \.(inc|old|svn|git|pub|sec|gpg)$ {
    deny all;
}
location ~* /(?:upload|files|pub)/.*\.php$ {
    deny all;
}

# deny scripts inside writable directories
location ~* /(images|cache|media|logs|tmp)/.*.(php|pl|py|jsp|asp|sh|cgi)$ {
    return 403;
    error_page 403 /403_error.html;
}

## Block download agenta
if ($http_user_agent ~* LWP::Simple|wget|libwww-perl) {
    return 403;
}

## Block some nasty robots
if ($http_user_agent ~ (msnbot|Purebot|Baiduspider|Lipperhey|Mail.Ru|scrapbot) ) {
    return 403;
}

## Deny referal spam
if ( $http_referer ~* (jewelry|viagra|nude|girl|nudit|casino|poker|porn|sex|teen|babes) ) {
    return 403; 
}

## Block attackers based on GeoIP countries, require maxmind db
#geoip_country /etc/nginx/GeoIP.dat;
#if ($geoip_country_code ~ (CN|KR|UK) ) {
#    return 403;
#}

## Stop Hotlinking
#location ~ .(gif|png|jpe?g)$ {
#     valid_referers none blocked mywebsite.com *.mywebsite.com;
#     if ($invalid_referer) {
#        return   403;
#    }
#}

