
large_client_header_buffers 2 1k;
client_header_buffer_size 1k;
client_max_body_size 5m;
client_body_buffer_size 10k;

add_header X-Content-Type-Options nosniff;
add_header X-Frame-Options SAMEORIGIN;
#add_header X-Frame-Options DENY;
add_header Strict-Transport-Security "max-age=63072000; includeSubdomains; preload";
add_header X-XSS-Protection "1; mode=block";
add_header Content-Security-Policy "default-src self"

## Note cookie are selective and must update $cookie_COOKIE to $cookie_target
log_format combined_long '$remote_addr - $remote_user [$time_local]  '
    '"$request" $status $body_bytes_sent '
    '"$http_referer" "$http_user_agent" "$cookie_COOKIE"';
access_log /var/log/nginx/access-long.log combined_long;

{% if hardenwebserver_nginx_debian_pkg is defined and hardenwebserver_nginx_debian_pkg == 'nginx-naxsi' and hardenwebserver_nginx_naxsi is defined and hardenwebserver_nginx_naxsi %}
include /etc/nginx/naxsi.rules;
{% endif %}

