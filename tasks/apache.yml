---

- include: apache-env.yml

- include: apache-security.yml

- include: apache-modsecurity.yml

- include: apache-ssl.yml
  when: hardenwebserver_cert is defined and hardenwebserver_cert == 'selfsigned'

- include: apache-https-only.yml
  when: hardenwebserver_disable_http is defined and hardenwebserver_disable_http

- include: apache-bind-debian.yml
  when: hardenwebserver_bind is defined and hardenwebserver_bind != "" and (ansible_distribution == 'Debian' or ansible_distribution == 'Ubuntu')
- include: apache-bind-redhat.yml
  when: hardenwebserver_bind is defined and hardenwebserver_bind != "" and (ansible_os_family == "RedHat" or ansible_distribution == 'CentOS' or ansible_distribution == 'Red Hat Enterprise Linux')

- name: ensure apache is enabled and started
  service: name={{ apache_svc }} state=started enabled=yes

